{% extends ('@App/layout.html.twig') %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('assets/css/separate/elements/steps.min.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ asset('assets/css/datatables.min.css') }}">
{% endblock %}

{% block javascript %}
    <script src="{{ asset('assets/js/datatables.min.js') }}"></script>
    <script src="{{ asset('assets/js/clientesnew.js') }}"></script>
    <script>
        $(document).ready(function () {
            $('a[href="#tabs-2-tab-1"]').click(function () {
                window.location = "{{ path('regClientes') }}";
            });
            $('#clientesType_numeroPermiso').bind('keyup', function() {
                var permiso = $('#clientesType_numeroPermiso').val();
                $.ajax({
                        type:'POST',
                        url:'{{ path('permiso') }}',
                        data:'permiso='+permiso,
                        success:function(html){
                            if(html==1){
                                $('#error-permiso').removeClass('hidden');
                                $('#error-permiso').html('El Número de Permiso EXISTE');
                            }else{
                                $('#error-permiso').addClass('hidden');
                                $('#error-permiso').html('');
                            }
                        }
                    });
            });
            $( "#clientesType_igual" ).click(function() {
                if($(this).is(':checked')){
                    $("#clientesType_calleFiscal").val($('#clientesType_calle').val());
                    $("#clientesType_codigoPostalFiscal").val($('#clientesType_codigoPostal').val());
                    var codigo = $("#clientesType_codigoPostalFiscal").val();
                    $.ajax({
                        type:'POST',
                        url:'{{ path('estado-codigo') }}',
                        data:'codigo='+codigo,
                        success:function(html){
                            $("#clientesType_estadoFiscal").val(html.estado);
                            var estadoID = html.estado;
                            if(estadoID){
                                $.ajax({
                                    type:'POST',
                                    url:'{{ path('municipios-json') }}',
                                    data:'estado='+estadoID,
                                    success:function(mun){
                                        $('#clientesType_municipioFiscal').find('option').remove();
                                        $.each(mun, function(i,item) {
                                            if(html.municipio==item.id){
                                                $('#clientesType_municipioFiscal').append('<option value="'+item.id+'" selected>'+item.municipio+'</option>');
                                            }else{
                                                $('#clientesType_municipioFiscal').append('<option value="'+item.id+'">'+item.municipio+'</option>');
                                            }
                                        });
                                        var municipioID = html.municipio;
                                        if(municipioID){
                                            $.ajax({
                                                type:'POST',
                                                url:'{{ path('colonias-json') }}',
                                                data:'municipio='+municipioID,
                                                success:function(html){
                                                    $('#clientesType_coloniaFiscal').find('option').remove();
                                                    $('#clientesType_coloniaFiscal').append('<option disabled selected value="null">Selecciona una Colonia</option>');
                                                    $.each(html, function(i,item) {
                                                        if(item.codigo==codigo){
                                                            if(item.id==$('#clientesType_colonia').val()){
                                                                $('#clientesType_coloniaFiscal').append('<option value="'+item.id+'" data-codigo="'+item.codigo+'" selected>'+item.colonia+'</option>');
                                                            }else{
                                                                $('#clientesType_coloniaFiscal').append('<option value="'+item.id+'" data-codigo="'+item.codigo+'">'+item.colonia+'</option>');
                                                            }
                                                        }
                                                    })
                                                }
                                            });
                                        }
                                    }
                                });
                            }
                        }
                    });
                }else{
                    $("#clientesType_calleFiscal").val('');
                    $("#clientesType_codigoPostalFiscal").val('');
                    $("#clientesType_estadoFiscal").val('null');
                    $('#clientesType_municipioFiscal').find('option').remove();
                    $('#clientesType_municipioFiscal').append('<option disabled selected value="null">Selecciona un Municipio</option>');
                    $('#clientesType_coloniaFiscal').find('option').remove();
                    $('#clientesType_coloniaFiscal').append('<option disabled selected value="null">Selecciona una Colonia</option>');
                }
            });
            $('#clientesType_codigoPostal').bind('keyup', function() {
                if($("#clientesType_codigoPostal").val().length==5){
                    var codigo = $("#clientesType_codigoPostal").val();
                    $.ajax({
                        type:'POST',
                        url:'{{ path('estado-codigo') }}',
                        data:'codigo='+codigo,
                        success:function(html){
                            $("#clientesType_estado").val(html.estado);
                            var estadoID = html.estado;
                            if(estadoID){
                                $.ajax({
                                    type:'POST',
                                    url:'{{ path('municipios-json') }}',
                                    data:'estado='+estadoID,
                                    success:function(mun){
                                        $('#clientesType_municipio').find('option').remove();
                                        $.each(mun, function(i,item) {
                                            if(html.municipio==item.id){
                                                $('#clientesType_municipio').append('<option value="'+item.id+'" selected>'+item.municipio+'</option>');
                                            }else{
                                                $('#clientesType_municipio').append('<option value="'+item.id+'">'+item.municipio+'</option>');
                                            }
                                        });
                                        var municipioID = html.municipio;
                                        if(municipioID){
                                            $.ajax({
                                                type:'POST',
                                                url:'{{ path('colonias-json') }}',
                                                data:'municipio='+municipioID,
                                                success:function(html){
                                                    $('#clientesType_colonia').find('option').remove();
                                                    $('#clientesType_colonia').append('<option disabled selected value="null">Selecciona una Colonia</option>');
                                                    $.each(html, function(i,item) {
                                                        if(item.codigo==codigo){
                                                            $('#clientesType_colonia').append('<option value="'+item.id+'" data-codigo="'+item.codigo+'">'+item.colonia+'</option>');
                                                        }
                                                    })
                                                }
                                            });
                                        }
                                    }
                                });
                            }
                        }
                    });
                }
            });
            $('#clientesType_codigoPostalFiscal').bind('keyup', function() {
                if($("#clientesType_codigoPostalFiscal").val().length==5){
                    var codigo = $("#clientesType_codigoPostalFiscal").val();
                    $.ajax({
                        type:'POST',
                        url:'{{ path('estado-codigo') }}',
                        data:'codigo='+codigo,
                        success:function(html){
                            $("#clientesType_estadoFiscal").val(html.estado);
                            var estadoID = html.estado;
                            if(estadoID){
                                $.ajax({
                                    type:'POST',
                                    url:'{{ path('municipios-json') }}',
                                    data:'estado='+estadoID,
                                    success:function(mun){
                                        $('#clientesType_municipioFiscal').find('option').remove();
                                        $.each(mun, function(i,item) {
                                            if(html.municipio==item.id){
                                                $('#clientesType_municipioFiscal').append('<option value="'+item.id+'" selected>'+item.municipio+'</option>');
                                            }else{
                                                $('#clientesType_municipioFiscal').append('<option value="'+item.id+'">'+item.municipio+'</option>');
                                            }
                                        });
                                        var municipioID = html.municipio;
                                        if(municipioID){
                                            $.ajax({
                                                type:'POST',
                                                url:'{{ path('colonias-json') }}',
                                                data:'municipio='+municipioID,
                                                success:function(html){
                                                    $('#clientesType_coloniaFiscal').find('option').remove();
                                                    $('#clientesType_coloniaFiscal').append('<option disabled selected value="null">Selecciona una Colonia</option>');
                                                    $.each(html, function(i,item) {
                                                        if(item.codigo==codigo){
                                                            $('#clientesType_coloniaFiscal').append('<option value="'+item.id+'" data-codigo="'+item.codigo+'">'+item.colonia+'</option>');
                                                        }
                                                    })
                                                }
                                            });
                                        }
                                    }
                                });
                            }
                        }
                    });
                }
            });
            $('#clientesType_marca').find('option').remove();
            $('#clientesType_marca').append('<option disabled selected value="null">Selecciona una Marca</option>');
            {% for m in marcas %}
                $('#clientesType_marca').append('<option value="{{ m.id }}">{{ m.nombre }}</option>');
            {% endfor %}
            /*$('#clientesType_marca').append('<option value="new">Nueva Marca</option>');
            $('#clientesType_marca').on('change',function(){
                if($(this).val()=='new'){
                    $('#fmarca').removeClass('hidden');
                }else{
                    $('#fmarca').addClass('hidden');
                }
            });*/
            $('#clientesType_asociacion').find('option').remove();
            $('#clientesType_asociacion').append('<option disabled selected value="null">Selecciona una Asociación</option>');
            {% for a in asociaciones %}
                $('#clientesType_asociacion').append('<option value="{{ a.id }}">{{ a.nombre }}</option>');
            {% endfor %}
            $('#clientesType_asociacion').append('<option value="new">Nueva Asociación</option>');
            $('#clientesType_asociacion').on('change',function(){
                if($(this).val()=='new'){
                    $('#fasociacion').removeClass('hidden');
                    $('#clientesType_macrogrupo').find('option').remove();
                    $('#clientesType_macrogrupo').append('<option disabled selected value="null">Selecciona una Unión</option>');
                    $('#clientesType_macrogrupo').append('<option value="new">Nueva Unión</option>');
                    $('#funion').addClass('hidden');
                    $('#clientesType_nuevomacrogrupo').val('');
                    $('#fgrupo').addClass('hidden');
                    $('#clientesType_nuevogrupo').val('');
                }else{
                    $('#fasociacion').addClass('hidden');
                    var asoID = $(this).val();
                    if(asoID){
                        $.ajax({
                            type:'POST',
                            url:'{{ path('asociacion-json') }}',
                            data:'asociacion='+asoID,
                            success:function(html){
                                $('#clientesType_macrogrupo').find('option').remove();
                                $('#clientesType_macrogrupo').append('<option disabled selected value="null">Selecciona una Unión</option>');
                                $.each(html, function(i,item) {
                                    $('#clientesType_macrogrupo').append('<option value="'+item.id+'" data-padre="'+item.padre+'">'+item.union+'</option>');
                                });
                                $('#clientesType_macrogrupo').append('<option value="new">Nueva Unión</option>');
                                $('#clientesType_grupo').find('option').remove();
                                $('#clientesType_grupo').append('<option disabled selected value="null">Selecciona un Grupo</option>');
                                $('#clientesType_grupo').append('<option value="new">Nuevo Grupo</option>');
                                $('#funion').addClass('hidden');
                                $('#clientesType_nuevomacrogrupo').val('');
                                $('#fgrupo').addClass('hidden');
                                $('#clientesType_nuevogrupo').val('');
                            }
                        });
                    }
                }
            });

            $('#clientesType_macrogrupo').find('option').remove();
            $('#clientesType_macrogrupo').append('<option disabled selected value="null">Selecciona una Unión</option>');
            {% for m in macros %}
                $('#clientesType_macrogrupo').append('<option value="{{ m.id }}" data-padre="{{ m.idGrupoPadre }}">{{ m.nombre }}</option>');
            {% endfor %}
            $('#clientesType_macrogrupo').append('<option value="new">Nueva Unión</option>');
            $('#clientesType_macrogrupo').on('change',function(){
                if($(this).val()=='new'){
                    $('#funion').removeClass('hidden');
                    $('#clientesType_grupo').find('option').remove();
                    $('#clientesType_grupo').append('<option disabled selected value="null">Selecciona un Grupo</option>');
                    $('#clientesType_grupo').append('<option value="new">Nuevo Grupo</option>');
                    $('#fgrupo').addClass('hidden');
                    $('#clientesType_nuevogrupo').val('');
                }else{
                    $('#funion').addClass('hidden');
                    if($(this).find(':selected').data('padre')!=0){
                        $('#clientesType_asociacion').val($(this).find(':selected').data('padre'));
                    }
                    var grupoID = $(this).val();
                    if(grupoID){
                        $.ajax({
                            type:'POST',
                            url:'{{ path('union-json') }}',
                            data:'union='+grupoID,
                            success:function(html){
                                $('#clientesType_grupo').find('option').remove();
                                $('#clientesType_grupo').append('<option disabled selected value="null">Selecciona un Grupo</option>');
                                $.each(html, function(i,item) {
                                    $('#clientesType_grupo').append('<option value="'+item.id+'" data-padre="'+item.padre+'">'+item.grupo+'</option>');
                                });
                                $('#clientesType_grupo').append('<option value="new">Nuevo Grupo</option>');
                                $('#fgrupo').addClass('hidden');
                                $('#clientesType_nuevogrupo').val('');
                            }
                        });
                    }
                }
            });

            $('#clientesType_grupo').find('option').remove();
            $('#clientesType_grupo').append('<option disabled selected value="null">Selecciona un Grupo</option>');
            {% for g in grupos %}
                $('#clientesType_grupo').append('<option value="{{ g.id }}" data-padre="{{ g.idGrupoPadre }}">{{ g.nombre }}</option>');
            {% endfor %}
            $('#clientesType_grupo').append('<option value="new">Nuevo Grupo</option>');
            $('#clientesType_grupo').on('change',function(){
                if($(this).val()=='new'){
                    $('#fgrupo').removeClass('hidden');
                }else{
                    $('#fgrupo').addClass('hidden');
                    if($(this).find(':selected').data('padre')!=0){
                        $('#clientesType_macrogrupo').val($(this).find(':selected').data('padre'));
                        if($('#clientesType_macrogrupo').find(':selected').data('padre')!=0){
                            $('#clientesType_asociacion').val($('#clientesType_macrogrupo').find(':selected').data('padre'));
                        }
                    }
                }
            });

            $( "input[name='clientesType[independiente]']" ).click(function() {
                if($(this).val()==1){
                    $('#noindependiente').addClass('hidden');
                }else{
                    $('#noindependiente').removeClass('hidden');
                }
            });
            {% if flow.currentStepNumber == 3 %}
                $('.btn.btn-rounded.float-right').click(function (e) {
                    if ($('#clientesType_independiente_0:checked').val() == 1 || $('#clientesType_independiente_1:checked').val() == 0) {
                        $('#error-independiente').addClass('hidden');
                    } else {
                        e.preventDefault();
                        $('#error-independiente').removeClass('hidden');
                        $('#error-independiente').html('Selecciona una Opción');
                    }
                });
            {% endif %}

            $('#clientesType_estado').append(new Option("Selecciona un Estado", "null",true,true));
            $("#clientesType_estado option:selected").attr('disabled','disabled');
            $('#clientesType_municipio').append(new Option("Selecciona un Municipio", "null",true,true));
            $("#clientesType_municipio option:selected").attr('disabled','disabled');
            $('#clientesType_colonia').append(new Option("Selecciona una Colonia", "null",true,true));
            $("#clientesType_colonia option:selected").attr('disabled','disabled');
            $('#clientesType_sector').append(new Option("Selecciona un Sector", "null",true,true));
            $("#clientesType_sector option:selected").attr('disabled','disabled');
            $('#clientesType_segmento').append(new Option("Selecciona un Segmento", "null",true,true));
            $("#clientesType_segmento option:selected").attr('disabled','disabled');
            $('#clientesType_categoria').append(new Option("Selecciona una Categoría", "null",true,true));
            $("#clientesType_categoria option:selected").attr('disabled','disabled');
            $('#clientesType_tipoClientes').append(new Option("Selecciona un Tipo de Cliente", "null",true,true));
            $("#clientesType_tipoClientes option:selected").attr('disabled','disabled');
            $('#clientesType_estadoFiscal').append(new Option("Selecciona un Estado", "null",true,true));
            $("#clientesType_estadoFiscal option:selected").attr('disabled','disabled');
            $("#clientesType_municipio option:selected").attr('disabled','disabled');
            $("#clientesType_colonia option:selected").attr('disabled','disabled');
            $('#clientesType_estado').on('change',function(){
                var estadoID = $(this).val();
                $('#clientesType_colonia').find('option').remove();
                $('#clientesType_colonia').append('<option disabled selected value="null">Selecciona una Colonia</option>');
                $('#clientesType_codigoPostal').val('');
                if(estadoID){
                    $.ajax({
                        type:'POST',
                        url:'{{ path('municipios-json') }}',
                        data:'estado='+estadoID,
                        success:function(html){
                            $('#clientesType_municipio').find('option').remove();
                            $('#clientesType_municipio').append('<option disabled selected value="null">Selecciona un Municipio</option>');
                            $.each(html, function(i,item) {
                                $('#clientesType_municipio').append('<option value="'+item.id+'">'+item.municipio+'</option>');
                            })
                        }
                    });
                }
            });
            $('#clientesType_municipio').on('change',function(){
                var municipioID = $(this).val();
                if(municipioID){
                    $.ajax({
                        type:'POST',
                        url:'{{ path('colonias-json') }}',
                        data:'municipio='+municipioID,
                        success:function(html){
                            $('#clientesType_colonia').find('option').remove();
                            $('#clientesType_colonia').append('<option disabled selected value="null">Selecciona una Colonia</option>');
                            $('#clientesType_codigoPostal').val('');
                            $.each(html, function(i,item) {
                                $('#clientesType_colonia').append('<option value="'+item.id+'" data-codigo="'+item.codigo+'">'+item.colonia+'</option>');
                            })
                        }
                    });
                }
            });
            $('#clientesType_colonia').on('change',function(){
                var codigo = $(this).find(':selected').attr('data-codigo');
                $('#clientesType_codigoPostal').val(codigo);
            });
            $('#clientesType_estadoFiscal').on('change',function(){
                var estadoID = $(this).val();
                $('#clientesType_coloniaFiscal').find('option').remove();
                $('#clientesType_coloniaFiscal').append('<option disabled selected value="null">Selecciona una Colonia</option>');
                $('#clientesType_codigoPostalFiscal').val('');
                if(estadoID){
                    $.ajax({
                        type:'POST',
                        url:'{{ path('municipios-json') }}',
                        data:'estado='+estadoID,
                        success:function(html){
                            $('#clientesType_municipioFiscal').find('option').remove();
                            $('#clientesType_municipioFiscal').append('<option disabled selected value="null">Selecciona un Municipio</option>');
                            $.each(html, function(i,item) {
                                $('#clientesType_municipioFiscal').append('<option value="'+item.id+'">'+item.municipio+'</option>');
                            })
                        }
                    });
                }
            });
            $('#clientesType_municipioFiscal').on('change',function(){
                var municipioID = $(this).val();
                if(municipioID){
                    $.ajax({
                        type:'POST',
                        url:'{{ path('colonias-json') }}',
                        data:'municipio='+municipioID,
                        success:function(html){
                            $('#clientesType_coloniaFiscal').find('option').remove();
                            $('#clientesType_coloniaFiscal').append('<option disabled selected value="null">Selecciona una Colonia</option>');
                            $('#clientesType_codigoPostalFiscal').val('');
                            $.each(html, function(i,item) {
                                $('#clientesType_coloniaFiscal').append('<option value="'+item.id+'" data-codigo="'+item.codigo+'">'+item.colonia+'</option>');
                            })
                        }
                    });
                }
            });
            $('#clientesType_coloniaFiscal').on('change',function(){
                var codigo = $(this).find(':selected').attr('data-codigo');
                $('#clientesType_codigoPostalFiscal').val(codigo);
            });
            $('#clientesType_sector').on('change',function(){
                var sectorID = $(this).val();
                if(sectorID){
                    $.ajax({
                        type:'POST',
                        url:'{{ path('sector-json') }}',
                        data:'sector='+sectorID,
                        success:function(html){
                            $('#clientesType_segmento').find('option').remove();
                            $('#clientesType_segmento').append('<option disabled selected value="null">Selecciona un Segmento</option>');
                            $.each(html, function(i,item) {
                                $('#clientesType_segmento').append('<option value="'+item.id+'">'+item.seg+'</option>');
                            })
                        }
                    });
                }
            });
            $('#clientesType_segmento').on('change',function(){
                var segmentoID = $(this).val();
                if(segmentoID){
                    $.ajax({
                        type:'POST',
                        url:'{{ path('segmento-json') }}',
                        data:'segmento='+segmentoID,
                        success:function(html){
                            $('#clientesType_categoria').find('option').remove();
                            $('#clientesType_categoria').append('<option disabled selected value="null">Selecciona una Categoría</option>');
                            $.each(html, function(i,item) {
                                $('#clientesType_categoria').append('<option value="'+item.id+'">'+item.cat+'</option>');
                            })
                        }
                    });
                }
            });
            $('#clientesType_marca').on('change',function(){
                var marcaID = $(this).val();
                $('#clientesType_productos').find('option').remove();
                if(marcaID){
                    $.ajax({
                        type:'POST',
                        url:'{{ path('producto-json') }}',
                        data:'marca='+marcaID,
                        success:function(html){
                            $('#clientesType_productos').find('option').remove();
                            $.each(html, function(i,item) {
                                $('#clientesType_productos').append('<option value="'+item.id+'">'+item.producto+'</option>');
                            })
                        }
                    });
                }
            });
            $('#tabla').DataTable( {
                "language":{
                    "decimal":        ".",
                    "emptyTable":     "No hay Registros",
                    "info":           "Mostrando del _START_ al _END_ de un total de _TOTAL_ registros",
                    "infoEmpty":      "Mostrando 0 de 0 de un total de 0 registros",
                    "infoFiltered":   "(Filtrado de _MAX_ registros)",
                    "infoPostFix":    "",
                    "thousands":      ",",
                    "lengthMenu":     "Mostrando _MENU_ registros",
                    "loadingRecords": "Cargando...",
                    "processing":     "Procesando...",
                    "search":         "Buscar:",
                    "searchPlaceholder": "Buscar Cliente",
                    "zeroRecords":    "Sin coincidencias",
                    "paginate": {
                        "first":      "Primero",
                        "last":       "Último",
                        "next":       "Siguiente",
                        "previous":   "Anterior"
                    }
                }
            } );
        });
    </script>
{% endblock %}

{% block body %}
    <style>
        .table{
            font-size: 0.8rem;
        }
    </style>
    <header class="section-header">
        <div class="tbl">
            <div class="tbl-row">
                <div class="tbl-cell">
                    <h2 class="inline-block">Registro de Clientes</h2>

                </div>
                <div class="tbl-cell text-right">
                    <nav class="inline-block" aria-label="breadcrumb">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="{{ path('regClientes') }}">Administrador</a></li>
                            <li class="breadcrumb-item active" aria-current="page">Clientes</li>
                        </ol>
                    </nav>
                </div>
            </div>
        </div>
    </header>
    <hr>
    <section class="tabs-section">
        <div class="tabs-section-nav">
            <div class="tbl">
                <ul class="nav" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active" href="#tabs-2-tab-1" role="tab" data-toggle="tab">
                            <span class="nav-link-in">
                                Registro
                                <span class="label label-pill label-success"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span></span>
                            </span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#tabs-2-tab-2" role="tab" data-toggle="tab">
                            <span class="nav-link-in">
                                Actualización
                                <span class="label label-pill label-danger"><span class="glyphicon glyphicon-refresh" aria-hidden="true"></span></span>
                            </span>
                        </a>
                    </li>
                </ul>
            </div>
        </div><!--.tabs-section-nav-->

        <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade in active" id="tabs-2-tab-1">
                <div class="row">
                    <div class="col-md-12">
                        <div class="steps-icon-progress">
                            {% include '@CraueFormFlow/FormFlow/stepList.html.twig' %}
                        </div>
                        {{ form_start(form) }}
                            {{ form_errors(form) }}
                            {% if flow.getCurrentStepNumber() == 1 %}
                                <div class="col-md-12">
                                    <fieldset class="form-group">
                                        <label class="form-label semibold" for="exampleInput">Razón Social</label>
                                        <div class="col-sm-11">
                                            {{ form_widget(form.razonSocial, {'attr': {'class': 'form-control', 'placeholder': 'Razón Social' } }) }}
                                            <p class="help-block hidden" id="error-razon"></p>
                                        </div>
                                    </fieldset>
                                </div>
                                <div class="col-md-6">
                                    <fieldset class="form-group">
                                        <label class="form-label semibold" for="exampleInput">Número de Permiso</label>
                                        <div class="col-sm-10">
                                            {{ form_widget(form.numeroPermiso, {'attr': {'class': 'form-control', 'placeholder': 'Número de Permiso' } }) }}
                                            <p class="help-block hidden" id="error-permiso"></p>
                                        </div>
                                    </fieldset>
                                    <fieldset class="form-group">
                                        <label class="form-label semibold" for="exampleInput">RFC</label>
                                        <div class="col-sm-10">
                                            {{ form_widget(form.rfc, {'attr': {'class': 'form-control', 'placeholder': 'RFC' } }) }}
                                            <p class="help-block hidden" id="error-rfc"></p>
                                        </div>
                                    </fieldset>
                                    <fieldset class="form-group">
                                        <label class="form-label semibold" for="exampleInput">Estación de Servicio</label>
                                        <div class="col-sm-10">
                                            {{ form_widget(form.estacionServicio, {'attr': {'class': 'form-control', 'placeholder': 'Estación de Servicio' } }) }}
                                            <p class="help-block hidden" id="error-estacion"></p>
                                        </div>
                                    </fieldset>
                                </div>
                                <div class="col-md-6">
                                    <fieldset class="form-group">
                                        <label class="form-label semibold" for="exampleInput">Teléfono de la Empresa</label>
                                        <div class="col-sm-10">
                                            {{ form_widget(form.telefonoEmpresa, {'attr': {'class': 'form-control', 'placeholder': 'Teléfono de la Empresa' } }) }}
                                            <p class="help-block hidden" id="error-telefono"></p>
                                        </div>
                                    </fieldset>
                                    <fieldset class="form-group">
                                        <label class="form-label semibold" for="exampleInput">Correo Electrónico de la Empresa</label>
                                        <div class="col-sm-10">
                                            {{ form_widget(form.correoEmpresa, {'attr': {'class': 'form-control', 'placeholder': 'Correo Electrónico de la Empresa' } }) }}
                                            <p class="help-block hidden" id="error-correo"></p>
                                        </div>
                                    </fieldset>
                                </div>
                            {% elseif flow.getCurrentStepNumber() == 2 %}
                                <div class="col-md-6">
                                    <h4>Domicilio Físico</h4>
                                    <fieldset class="form-group">
                                        <label class="form-label semibold" for="exampleInput">Calle</label>
                                        <div class="col-sm-10">
                                            {{ form_widget(form.calle, {'attr': {'class': 'form-control', 'placeholder': 'Calle' } }) }}
                                            <p class="help-block hidden" id="error-calle"></p>
                                        </div>
                                    </fieldset>
                                    <fieldset class="form-group">
                                        <label class="form-label semibold" for="exampleInput">Estado</label>
                                        <div class="col-sm-10">
                                            {{ form_widget(form.estado, {'attr': {'placeholder': 'Estado' } }) }}
                                            <p class="help-block hidden" id="error-estado"></p>
                                        </div>
                                    </fieldset>
                                    <fieldset class="form-group">
                                        <label class="form-label semibold" for="exampleInput">Municipio</label>
                                        <div class="col-sm-10">
                                            {{ form_widget(form.municipio, {'attr': {'placeholder': 'Municipio' } }) }}
                                            <p class="help-block hidden" id="error-municipio"></p>
                                        </div>
                                    </fieldset>
                                    <fieldset class="form-group">
                                        <label class="form-label semibold" for="exampleInput">Colonia</label>
                                        <div class="col-sm-10">
                                            {{ form_widget(form.colonia, {'attr': {'placeholder': 'Colonia' } }) }}
                                            <p class="help-block hidden" id="error-colonia"></p>
                                        </div>
                                    </fieldset>
                                    <fieldset class="form-group">
                                        <label class="form-label semibold" for="exampleInput">Código Postal</label>
                                        <div class="col-sm-5">
                                            {{ form_widget(form.codigoPostal, {'attr': {'placeholder': 'Código Postal' } }) }}
                                            <p class="help-block hidden" id="error-codigo"></p>
                                        </div>
                                    </fieldset>
                                    <fieldset class="form-group">
                                        <label class="form-label semibold" for="exampleInput">Coordenadas</label>
                                        <div class="col-sm-10">
                                            <div class="col-sm-6">
                                                {{ form_widget(form.coordenadaX, {'attr': {'class': 'form-control', 'placeholder': 'Coordenada Y' } }) }}
                                                <p class="help-block hidden" id="error-coorx"></p>
                                            </div>
                                            <div class="col-sm-6">
                                                {{ form_widget(form.coordenadaY, {'attr': {'class': 'form-control', 'placeholder': 'Coordenada X' } }) }}
                                                <p class="help-block hidden" id="error-coory"></p>
                                            </div>
                                        </div>
                                    </fieldset>
                                </div>
                                <div class="col-md-6">
                                    <h4>Domicilio Fiscal</h4>
                                    <fieldset class="form-group" id="check-igual">
                                        <label class="form-label semibold" for="clientesType_igual">Utilizar domicilio Físico</label>
                                        <div class="col-sm-6">
                                            {{ form_widget(form.igual, {'attr': {'class': 'form-control' } }) }}
                                        </div>
                                    </fieldset>
                                    <fieldset class="form-group">
                                        <label class="form-label semibold" for="exampleInput">Calle</label>
                                        <div class="col-sm-10">
                                            {{ form_widget(form.calleFiscal, {'attr': {'class': 'form-control', 'placeholder': 'Calle' } }) }}
                                            {% if form.calleFiscal.vars.errors|length > 0 %}
                                                <p class="help-block" id="error-nombre">
                                                    {% for error in form.calleFiscal.vars.errors %}
                                                        {{ error.message }} <br/>
                                                    {% endfor %}
                                                </p>
                                            {% endif %}
                                        </div>
                                    </fieldset>
                                    <fieldset class="form-group">
                                        <label class="form-label semibold" for="exampleInput">Estado</label>
                                        <div class="col-sm-10">
                                            {{ form_widget(form.estadoFiscal, {'attr': {'placeholder': 'Estado' } }) }}
                                            {% if form.estadoFiscal.vars.errors|length > 0 %}
                                                <p class="help-block" id="error-nombre">
                                                    {% for error in form.estadoFiscal.vars.errors %}
                                                        {{ error.message }} <br/>
                                                    {% endfor %}
                                                </p>
                                            {% endif %}
                                        </div>
                                    </fieldset>
                                    <fieldset class="form-group">
                                        <label class="form-label semibold" for="exampleInput">Municipio</label>
                                        <div class="col-sm-10">
                                            {{ form_widget(form.municipioFiscal, {'attr': {'placeholder': 'Municipio' } }) }}
                                            {% if form.municipioFiscal.vars.errors|length > 0 %}
                                                <p class="help-block" id="error-nombre">
                                                    {% for error in form.municipioFiscal.vars.errors %}
                                                        {{ error.message }} <br/>
                                                    {% endfor %}
                                                </p>
                                            {% endif %}
                                        </div>
                                    </fieldset>
                                    <fieldset class="form-group">
                                        <label class="form-label semibold" for="exampleInput">Colonia</label>
                                        <div class="col-sm-10">
                                            {{ form_widget(form.coloniaFiscal, {'attr': {'placeholder': 'Colonia' } }) }}
                                            {% if form.coloniaFiscal.vars.errors|length > 0 %}
                                                <p class="help-block" id="error-nombre">
                                                    {% for error in form.coloniaFiscal.vars.errors %}
                                                        {{ error.message }} <br/>
                                                    {% endfor %}
                                                </p>
                                            {% endif %}
                                        </div>
                                    </fieldset>
                                    <fieldset class="form-group">
                                        <label class="form-label semibold" for="exampleInput">Código Postal</label>
                                        <div class="col-sm-5">
                                            {{ form_widget(form.codigoPostalFiscal, {'attr': {'placeholder': 'Código Postal' } }) }}
                                            <p class="help-block hidden" id="error-codigofiscal"></p>
                                        </div>
                                    </fieldset>
                                </div>
                            {% elseif flow.getCurrentStepNumber() == 3 %}
                                <div class="col-md-6">
                                    <h4>Datos Específicos</h4>
                                    <fieldset class="form-group">
                                        <label class="form-label semibold" for="exampleInput">Tipo de Cliente</label>
                                        <div class="col-sm-10">
                                            {{ form_widget(form.tipoClientes, {'attr': {'class': 'form-control', 'placeholder': 'Tipo de Cliente' } }) }}
                                            <p class="help-block hidden" id="error-tipoCliente"></p>
                                        </div>
                                    </fieldset>
                                    <fieldset class="form-group">
                                        <label class="form-label semibold" for="exampleInput">Sector</label>
                                        <div class="col-sm-10">
                                            {{ form_widget(form.sector, {'attr': {'class': 'form-control', 'placeholder': 'Sector' } }) }}
                                            <p class="help-block hidden" id="error-sector"></p>
                                        </div>
                                    </fieldset>
                                    <fieldset class="form-group">
                                        <label class="form-label semibold" for="exampleInput">Segmento</label>
                                        <div class="col-sm-10">
                                            {{ form_widget(form.segmento, {'attr': {'class': 'form-control', 'placeholder': 'Segmento' } }) }}
                                            <p class="help-block hidden" id="error-segmento"></p>
                                        </div>
                                    </fieldset>
                                    <fieldset class="form-group">
                                        <label class="form-label semibold" for="exampleInput">Categoría</label>
                                        <div class="col-sm-10">
                                            {{ form_widget(form.categoria, {'attr': {'class': 'form-control', 'placeholder': 'Categoría' } }) }}
                                            <p class="help-block hidden" id="error-categoria"></p>
                                        </div>
                                    </fieldset>
                                    <fieldset class="form-group">
                                        <label class="form-label semibold" for="exampleInput">Marca</label>
                                        <div class="col-sm-10">
                                            {{ form_widget(form.marca, {'attr': {'class': 'form-control', 'placeholder': 'Marca' } }) }}
                                            <p class="help-block hidden" id="error-marca"></p>
                                        </div>
                                    </fieldset>
                                    <fieldset class="form-group">
                                        <label class="form-label semibold" for="exampleInput">Productos</label>
                                        <div class="col-sm-10">
                                            {{ form_widget(form.productos, {'attr': {'class': 'form-control select2','multiple':'multiple', 'placeholder': 'Productos' } }) }}
                                            {{ form_widget(form.lista, {'attr': {'class': 'form-control hidden' } }) }}
                                            <p class="help-block hidden" id="error-producto"></p>
                                        </div>
                                    </fieldset>
                                    <fieldset class="form-group hidden" id="fmarca">
                                        <label class="form-label semibold" for="exampleInput">Nueva Marca</label>
                                        <div class="col-sm-10">
                                            {{ form_widget(form.nuevamarca, {'attr': {'class': 'form-control', 'placeholder': 'Nueva Marca' } }) }}
                                            <p class="help-block hidden" id="error-nuevamarca"></p>
                                        </div>
                                    </fieldset>
                                    <fieldset class="form-group">
                                        <label class="form-label semibold" for="exampleInput">¿Es Independiente?</label>
                                        <div class="col-sm-10">
                                            <div class="form-control">
                                                <label class="inline-block mr-10">
                                                    {{ form_widget(form.independiente.0) }} Si
                                                </label>
                                                <label class="inline-block">
                                                    {{ form_widget(form.independiente.1) }} No
                                                </label>
                                            </div>
                                            <p class="help-block hidden" id="error-independiente"></p>
                                        </div>
                                    </fieldset>
                                </div>
                                <div class="col-md-6 hidden" id="noindependiente">
                                    <p id="error-grupos" class="hidden help-block"></p>
                                    <fieldset class="form-group" style="margin-top: 2.7rem;">
                                        <label class="form-label semibold" for="exampleInput">Asociación</label>
                                        <div class="col-sm-10">
                                            {{ form_widget(form.asociacion, {'attr': {'class': 'form-control', 'placeholder': 'Asociación' } }) }}
                                            <p class="help-block hidden" id="error-asociacion"></p>
                                        </div>
                                    </fieldset>
                                    <fieldset class="form-group hidden" id="fasociacion">
                                        <label class="form-label semibold" for="exampleInput">Nueva Asociación</label>
                                        <div class="col-sm-10">
                                            {{ form_widget(form.nuevaasociacion, {'attr': {'class': 'form-control', 'placeholder': 'Nueva Asociación' } }) }}
                                            <p class="help-block hidden" id="error-nuevaasociacion"></p>
                                        </div>
                                    </fieldset>
                                    <fieldset class="form-group">
                                        <label class="form-label semibold" for="exampleInput">Unión</label>
                                        <div class="col-sm-10">
                                            {{ form_widget(form.macrogrupo, {'attr': {'class': 'form-control', 'placeholder': 'Unión' } }) }}
                                            <p class="help-block hidden" id="error-union"></p>
                                        </div>
                                    </fieldset>
                                    <fieldset class="form-group hidden" id="funion">
                                        <label class="form-label semibold" for="exampleInput">Nueva Unión</label>
                                        <div class="col-sm-10">
                                            {{ form_widget(form.nuevomacrogrupo, {'attr': {'class': 'form-control', 'placeholder': 'Nueva Unión' } }) }}
                                            <p class="help-block hidden" id="error-nuevaunion"></p>
                                        </div>
                                    </fieldset>
                                    <fieldset class="form-group">
                                        <label class="form-label semibold" for="exampleInput">Grupo</label>
                                        <div class="col-sm-10">
                                            {{ form_widget(form.grupo, {'attr': {'class': 'form-control', 'placeholder': 'Grupo' } }) }}
                                            <p class="help-block hidden" id="error-grupo"></p>
                                        </div>
                                    </fieldset>
                                    <fieldset class="form-group hidden" id="fgrupo">
                                        <label class="form-label semibold" for="exampleInput">Nuevo Grupo</label>
                                        <div class="col-sm-10">
                                            {{ form_widget(form.nuevogrupo, {'attr': {'class': 'form-control', 'placeholder': 'Nuevo Grupo' } }) }}
                                            <p class="help-block hidden" id="error-nuevogrupo"></p>
                                        </div>
                                    </fieldset>
                                </div>
                            {% elseif flow.getCurrentStepNumber() == 4 %}
                                <div class="col-md-12 text-center">
                                    <h3>Da clic en Enviar para Finalizar el Registro</h3>
                                </div>
                            {% endif %}
                        <div class="col-sm-12 buttons">
                            {{ form_rest(form) }}
                            {% if flow.currentStepNumber == 1 or flow.currentStepNumber == 2 or flow.currentStepNumber == 3 %}
                                {% include '@CraueFormFlow/FormFlow/buttons.html.twig' with {
                                    craue_formflow_button_label_reset: 'reiniciar',
                                    craue_formflow_button_label_back: 'atras',
                                    craue_formflow_button_label_last: 'siguiente',
                                    craue_formflow_button_class_last: 'btn btn-primary default float-right',
                                    craue_formflow_button_class_back: 'btn btn-secondary float-left',
                                    craue_formflow_button_class_reset: 'btn btn-danger float-right mr-10'
                                } %}
                            {% else %}
                                {% include '@CraueFormFlow/FormFlow/buttons.html.twig' with {
                                    craue_formflow_button_label_finish: 'enviar',
                                    craue_formflow_button_label_reset: 'reiniciar',
                                    craue_formflow_button_label_back: 'atras',
                                    craue_formflow_button_class_last: 'btn btn-success float-right',
                                    craue_formflow_button_class_back: 'btn btn-secondary float-left',
                                    craue_formflow_button_class_reset: 'btn btn-danger float-right mr-10'
                                } %}
                            {% endif %}
                        </div>
                        {{ form_end(form) }}
                    </div>
                </div>
                <h3></h3>
                <hr>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="tabs-2-tab-2">
                <div class="row">
                    <div class="col-lg-12">
                        <style>
                            #tabla td{
                                text-align: center;
                            }
                        </style>
                        <table id="tabla" class="table is-bordered is-striped is-narrow is-hoverable table-responsive" style="width: 100%;">
                            <thead>
                            <tr>
                                <td>Número de Permiso</td>
                                <td>Razón Social</td>
                                <td>Tipo de Cliente</td>
                                <td>Estado</td>
                                <td>Marca</td>
                                <td>Asociación</td>
                                <td>Unión</td>
                                <td>Grupo</td>
                                <td>Detalle</td>
                                <td>Google Maps</td>
                            </tr>
                            </thead>

                            <tbody>
                            {% for c in lista %}
                                <tr class="has-text-centered">
                                    <td>{{ c.clientes.numeroPermiso }}</td>
                                    <td>{{ c.clientes.razonSocial }}</td>
                                    <td>{{ c.clientes.tipoClientes.nombre }}</td>
                                    <td>{{ c.municipios.estados.nombre }}</td>
                                    {% set x = 0 %}
                                    {% for p in productos %}
                                        {% if p.clientes.id == c.clientes.id and x==0 %}
                                            <td>{{ p.productos.marcas.nombre }}</td>
                                            {% set x = 1 %}
                                        {% endif %}
                                    {% endfor %}
                                    {% if x==0 %}
                                        <td>-----</td>
                                    {% endif %}
                                    <td>
                                        {% if c.clientes.grupos is not null and c.clientes.grupos.tipoGrupos.id==1 %}
                                            {{ c.clientes.grupos.nombre }}
                                        {% elseif c.clientes.grupos is not null and c.clientes.grupos.tipoGrupos.id==2 %}
                                            {% for x in gruposall %}
                                                {% if c.clientes.grupos.idGrupoPadre == x.id %}
                                                    {{ x.nombre }}
                                                {% endif %}
                                            {% endfor %}
                                        {% elseif c.clientes.grupos is not null and c.clientes.grupos.tipoGrupos.id==3 %}
                                            {% set ban = 0 %}
                                            {% for x in gruposall %}
                                                {% if c.clientes.grupos.idGrupoPadre == x.id %}
                                                    {% for y in gruposall %}
                                                        {% if x.idGrupoPadre == y.id %}
                                                            {{ y.nombre }}
                                                            {% set ban = 1 %}
                                                        {% endif %}
                                                    {% endfor %}
                                                {% endif %}
                                            {% endfor %}
                                            {% if ban == 0 %}
                                                -----
                                            {% endif %}
                                        {% elseif c.clientes.grupos is not null and c.clientes.grupos.tipoGrupos.id==4 %}
                                            -----
                                        {% else %}
                                            -----
                                        {% endif %}
                                    </td>
                                    <td>
                                        {% if c.clientes.grupos is not null and c.clientes.grupos.tipoGrupos.id==1 %}
                                            -----
                                        {% elseif c.clientes.grupos is not null and c.clientes.grupos.tipoGrupos.id==2 %}
                                            {{ c.clientes.grupos.nombre }}
                                        {% elseif c.clientes.grupos is not null and c.clientes.grupos.tipoGrupos.id==3 %}
                                            {% for x in gruposall %}
                                                {% if c.clientes.grupos.idGrupoPadre == x.id %}
                                                    {{ x.nombre }}
                                                {% endif %}
                                            {% endfor %}
                                        {% elseif c.clientes.grupos is not null and c.clientes.grupos.tipoGrupos.id==4 %}
                                            -----
                                        {% else %}
                                            -----
                                        {% endif %}
                                    </td>
                                    <td>
                                        {% if c.clientes.grupos is not null and c.clientes.grupos.tipoGrupos.id==1 %}
                                            -----
                                        {% elseif c.clientes.grupos is not null and c.clientes.grupos.tipoGrupos.id==2 %}
                                            -----
                                        {% elseif c.clientes.grupos is not null and c.clientes.grupos.tipoGrupos.id==3 %}
                                            {{ c.clientes.grupos.nombre }}
                                        {% elseif c.clientes.grupos is not null and c.clientes.grupos.tipoGrupos.id==4 %}
                                            -----
                                        {% else %}
                                            -----
                                        {% endif %}
                                    </td>
                                    <td>
                                        <a href="{{ path('editar-cliente',{'id':c.clientes.id}) }}" class="button is-success">
                                            <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                                        </a>
                                    </td>
                                    <td><a href="https://www.google.com/maps?q={{ c.clientes.coordenadaX }},{{ c.clientes.coordenadaY }}" target="_blank"><i class="fa fa-map-marker"></i></a></td>
                                </tr>
                            {% endfor %}

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </section>
{% endblock %}